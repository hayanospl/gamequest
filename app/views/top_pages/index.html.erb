<%= render 'shared/flash_messages' %>
<div class="text-center">
<h2><%= button_to '投稿', new_post_path, method: :get %></h2>
<h2><%= button_to 'プロフィール', users_show_path, method: :get %></h2>
</div>

<% if user_signed_in? && @recommends.present?%>
  <h3><%=@recommend_tag%>に興味がある人におすすめ</h3>
  <table class="table">
    <thead>
      <tr>
        <th scope="col">既読</th>
        <th scope="col">NO.</th>
        <th scope="col">ユーザー</th>
        <th scope="col">タイトル</th>
        <th scope="col">本文</th>
        <th scope="col">タグ</th>
        <th scope="col">返信数</th>
        <th scope="col">いいね数</th>
        <th scope="col">投稿詳細</th>
      </tr>
    </thead>

    <tbody>
      <% @recommends.each do |reco| %>
            <%= render 'shared/alreadyread', post: reco %>
            <th scope="row"><%= reco.id %></th>
            <td scope="row"><%= reco.user.name %></td>
            <td scope="row"><%= reco.title %></td>
            <td scope="row"><%= reco.content %></td>
            <td scope="row">
                      <%  reco.tag_list.each do |tag| %>
                            <%= link_to tag, root_path(tag_name: tag) %>
                      <% end %>
              </td>
            <td scope="row"><%= reco.comments.count %></td>
            <td scope="row"><%= reco.likes.count %></td>
            <td scope="row"><%= link_to "詳細", post_path(reco.id) %></td>
            </tr>
      <% end %>
    </tbody>
  </table>
<%= paginate @recommends %>
<% end %>

<h5>投稿一覧</h5>
<table class="table">
  <thead>
    <tr>
      <% if user_signed_in? %>
        <th scope="col">既読</th>
      <% end %>
      <th scope="col">NO.</th>
      <th scope="col">ユーザー</th>
      <th scope="col">タイトル</th>
      <th scope="col">本文</th>
      <th scope="col">タグ</th>
      <th scope="col">返信数</th>
      <th scope="col">いいね数</th>
      <th scope="col">投稿詳細</th>
    </tr>
  </thead>

  <tbody>
      <% @posts.each do |post| %>
          <% if user_signed_in? %>
            <%= render 'shared/alreadyread', post: post %>
          <% end %>
          <th scope="row"><%= post.id %></th>
          <td scope="row"><%= post.user.name %></td>
          <td scope="row"><%= post.title %></td>
          <td scope="row"><%= post.content %></td>
          <td scope="row">
                    <%  post.tag_list.each do |tag| %>
                          <%= link_to tag, root_path(tag_name: tag) %>
                    <% end %>
            </td>
          <td scope="row"><%= post.comments.count %></td>
          <td scope="row"><%= post.likes.count %></td>
          <td scope="row"><%= link_to "詳細", post_path(post.id) %></td>
        </tr>
    <% end %>
  </tbody>
</table>

<%= paginate @posts -%>
